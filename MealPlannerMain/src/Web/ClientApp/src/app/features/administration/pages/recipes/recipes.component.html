<div class="card content-height-full">
    <p-table
        #recipeTable
        [scrollable]="true"
        scrollHeight="90%"
        [value]="recipes$ | async"
        dataKey="id"
        [expandedRowKeys]="expandedrecipe"
        [globalFilterFields]="['name']"
        [style]="{ height: 'calc(100vh - 14rem)' }"
        (onRowExpand)="onRowExpand($event)"
    >
        <ng-template pTemplate="caption">
            <div class="flex">
                <div class="flex flex-wrap justify-content-end gap-2">
                    <p-button
                        label="Add recipe"
                        icon="pi pi-plus"
                        [outlined]="true"
                        severity="info"
                        (onClick)="displayRecipeDialog()"
                    />
                </div>
                <span class="p-input-icon-left ml-auto">
                    <i class="pi pi-search"></i>
                    <input
                        #searchInput
                        pInputText
                        type="text"
                        [(ngModel)]="searchValue"
                        (input)="
                            recipeTable.filterGlobal(
                                searchInput.value,
                                'contains'
                            )
                        "
                        placeholder="Search recipe"
                    />
                </span>
            </div>
        </ng-template>
        <ng-template pTemplate="body" let-recipe let-expanded="expanded">
            <tr #recipeRow [attr.data-id]="recipe.id">
                <td class="left-toggle-expand">
                    <p-button
                        type="button"
                        pRipple
                        [pRowToggler]="recipe"
                        [text]="true"
                        [rounded]="true"
                        [plain]="true"
                        [icon]="
                            expanded
                                ? 'pi pi-chevron-down'
                                : 'pi pi-chevron-right'
                        "
                    />
                </td>
                <td class="left-align-text">{{ recipe.name }}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-recipedetail>
            <tr *ngIf="expandedrecipe[recipedetail.id]">
                <td></td>
                <td>
                    <app-recipe-setup [recipeId]="recipedetail.id" />
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
